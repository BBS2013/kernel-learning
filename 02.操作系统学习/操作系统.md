ä»¥ä¸‹æ˜¯å¯¹æ“ä½œç³»ç»Ÿæ ¸å¿ƒæ¦‚å¿µçš„ç³»ç»Ÿæ€§è®²è§£ï¼Œç»“åˆç»å…¸æ•™æã€Šæ“ä½œç³»ç»Ÿæ¦‚å¿µï¼ˆç¬¬ä¸ƒç‰ˆï¼‰ã€‹çš„æ¡†æ¶ï¼Œåˆ†ä¸ºå…­ä¸ªéƒ¨åˆ†å¸®åŠ©æ‚¨å»ºç«‹å®Œæ•´çŸ¥è¯†ä½“ç³»ï¼š

------

### ä¸€ã€æ“ä½œç³»ç»Ÿçš„æœ¬è´¨ä¸æ ¸å¿ƒç›®æ ‡

**å®šä¹‰**
 æ“ä½œç³»ç»Ÿï¼ˆOSï¼‰æ˜¯è®¡ç®—æœºç¡¬ä»¶ä¸ç”¨æˆ·/åº”ç”¨ç¨‹åºä¹‹é—´çš„â€‹**â€‹ä¸­ä»‹å±‚â€‹**â€‹ï¼Œæ ¸å¿ƒèŒè´£åŒ…æ‹¬ï¼š

1. **èµ„æºç®¡ç†è€…**ï¼šç»Ÿä¸€ç®¡æ§CPUã€å†…å­˜ã€I/Oè®¾å¤‡ç­‰ç¡¬ä»¶èµ„æºï¼ˆæ•™æ1.1.2èŠ‚ï¼‰
2. **æœåŠ¡æä¾›è€…**ï¼šä¸ºåº”ç”¨ç¨‹åºæä¾›æ–‡ä»¶ç³»ç»Ÿã€è¿›ç¨‹æ§åˆ¶ç­‰åŸºç¡€æœåŠ¡ï¼ˆç¬¬2ç« ï¼‰
3. **ç³»ç»Ÿä¿æŠ¤è€…**ï¼šé€šè¿‡éš”ç¦»æœºåˆ¶é˜²æ­¢ç¨‹åºè¶Šæƒè®¿é—®ç¡¬ä»¶ï¼ˆç¬¬14-15ç« ï¼‰

**åŒé‡è®¾è®¡ç›®æ ‡**

- **ç”¨æˆ·è§†è§’**ï¼šæå‡æ˜“ç”¨æ€§ï¼ˆå¦‚GUIç•Œé¢ã€APIæŠ½è±¡ï¼‰
- **ç³»ç»Ÿè§†è§’**ï¼šä¼˜åŒ–èµ„æºåˆ©ç”¨ç‡ï¼ˆå¦‚å¤šä»»åŠ¡è°ƒåº¦ã€è™šæ‹ŸåŒ–æŠ€æœ¯ï¼‰

> *æ•™ææ¡ˆä¾‹*ï¼šæ‰‹æŒè®¾å¤‡OSéœ€å¹³è¡¡åŠŸè€—ä¸å“åº”é€Ÿåº¦ï¼ˆ1.11.3èŠ‚ï¼‰

------

# äºŒã€æ“ä½œç³»ç»Ÿæ ¸å¿ƒåŠŸèƒ½æ¨¡å—

# 1. è¿›ç¨‹ç®¡ç†ï¼ˆç¬¬3-7ç« ï¼‰

- **è¿›ç¨‹ vs çº¿ç¨‹**

  - è¿›ç¨‹ï¼šèµ„æºåˆ†é…çš„åŸºæœ¬å•ä½ï¼ˆå«ä»£ç æ®µã€æ•°æ®æ®µã€PCBï¼‰
  - çº¿ç¨‹ï¼šCPUè°ƒåº¦çš„åŸºæœ¬å•ä½ï¼ˆå…±äº«è¿›ç¨‹èµ„æºï¼‰

  > *å®ç°æ¨¡å‹*ï¼šWindows XPé‡‡ç”¨1:1çº¿ç¨‹æ¨¡å‹ï¼ˆ4.5.1èŠ‚ï¼‰


- **è¿›ç¨‹åŒæ­¥æœºåˆ¶**

  | æœºåˆ¶     | åŸç†                       | å…¸å‹åº”ç”¨          |
  | -------- | -------------------------- | ----------------- |
  | ä¿¡å·é‡   | P/VåŸå­æ“ä½œæ§åˆ¶èµ„æºè®¿é—®    | ç”Ÿäº§è€…-æ¶ˆè´¹è€…é—®é¢˜ |
  | ç®¡ç¨‹     | å°è£…åŒæ­¥æ“ä½œçš„æŠ½è±¡æ•°æ®ç±»å‹ | JavaåŒæ­¥å—        |
  | åŸå­äº‹åŠ¡ | ACIDç‰¹æ€§ä¿è¯æ“ä½œåŸå­æ€§     | æ•°æ®åº“ç³»ç»Ÿ        |

## 1.1è¿›ç¨‹é—´æ˜¯å¦‚ä½•è¿›è¡Œé€šä¿¡ï¼Ÿå¯ä»¥å†™å‡ ä¸ªä¾‹å­ç»™æˆ‘çœ‹çœ‹ã€‚

wslï¼šcd  "/mnt/c/program file"



## 1.2å…±äº«å†…å­˜é€šä¿¡

åœ¨ C++ ä¸­ï¼Œä½¿ç”¨ **System V å…±äº«å†…å­˜**ï¼ˆSystem V Shared Memoryï¼‰æ˜¯ä¸€ç§å¸¸è§çš„è¿›ç¨‹é—´é€šä¿¡æ–¹å¼ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„å…±äº«å†…å­˜é€šä¿¡ç¤ºä¾‹ï¼Œåˆ†ä¸ºä¸¤ä¸ªç¨‹åºï¼š

- `server.cpp`ï¼šåˆ›å»ºå…±äº«å†…å­˜å¹¶å†™å…¥æ•°æ®ï¼›
- `client.cpp`ï¼šè¿æ¥åˆ°å…±äº«å†…å­˜å¹¶è¯»å–æ•°æ®ã€‚

---

### âœ… ç¤ºä¾‹ç›®æ ‡

- ä½¿ç”¨å…±äº«å†…å­˜è¿›è¡Œè¿›ç¨‹é—´é€šä¿¡ï¼›
- `server` å†™å…¥æ•°æ®ï¼›
- `client` è¯»å–æ•°æ®ï¼›
- ä½¿ç”¨ `sleep(2)` æ¨¡æ‹ŸåŒæ­¥ï¼ˆç®€å•åœºæ™¯ä¸‹ä½¿ç”¨ï¼‰ï¼›
- ä½¿ç”¨æ ‡å‡†çš„ System V å…±äº«å†…å­˜æ¥å£ï¼ˆPOSIX ä¹Ÿå¯ä»¥ï¼Œä½†æ­¤å¤„ç”¨ System Vï¼‰ã€‚

---

### ğŸ“ æ–‡ä»¶ç»“æ„

```
shared_memory_example/
â”œâ”€â”€ server.cpp
â”œâ”€â”€ client.cpp
```

---

## ğŸŸ¦ server.cpp

```cpp
#include <iostream>
#include <cstdlib>
#include <cstring>
#include <sys/ipc.h>
#include <sys/shm.h>
#include <unistd.h>  // for sleep()

#define SHM_KEY 1234
#define SHM_SIZE 1024

int main() {
    // åˆ›å»ºå…±äº«å†…å­˜æ®µ
    int shmid = shmget(SHM_KEY, SHM_SIZE, IPC_CREAT | 0666);
    if (shmid == -1) {
        perror("shmget failed");
        return 1;
    }

    // å°†å…±äº«å†…å­˜é™„åŠ åˆ°å½“å‰è¿›ç¨‹
    char *shm = (char *)shmat(shmid, nullptr, 0);
    if (shm == (char *)-1) {
        perror("shmat failed");
        return 1;
    }

    // å†™å…¥æ•°æ®
    const char *message = "Hello from shared memory!";
    strcpy(shm, message);
    std::cout << "Server: Wrote message to shared memory." << std::endl;

    // ç­‰å¾…å®¢æˆ·ç«¯è¯»å–
    sleep(2);

    // åˆ†ç¦»å…±äº«å†…å­˜
    if (shmdt(shm) == -1) {
        perror("shmdt failed");
        return 1;
    }

    // åˆ é™¤å…±äº«å†…å­˜
    if (shmctl(shmid, IPC_RMID, nullptr) == -1) {
        perror("shmctl(IPC_RMID) failed");
        return 1;
    }

    return 0;
}
```

---

## ğŸŸ© client.cpp

```cpp
#include <iostream>
#include <cstdlib>
#include <cstring>
#include <sys/ipc.h>
#include <sys/shm.h>

#define SHM_KEY 1234
#define SHM_SIZE 1024

int main() {
    // è·å–å…±äº«å†…å­˜æ®µ
    int shmid = shmget(SHM_KEY, SHM_SIZE, 0666);
    if (shmid == -1) {
        perror("shmget failed");
        return 1;
    }

    // å°†å…±äº«å†…å­˜é™„åŠ åˆ°å½“å‰è¿›ç¨‹
    char